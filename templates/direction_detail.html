{% extends 'base.html' %}

{% block title %}{{ direction.direction_name }} - {{ direction.university.full_name }}{% endblock %}

{% block head %}
{# Add specific CSS or JS for this page if needed #}
<style>
    .detail-section { margin-bottom: 1.5rem; }
    .detail-label { font-weight: 600; color: #4b5563; /* gray-600 */ }
    .detail-value { color: #1f2937; /* gray-800 */ }
     .badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px; /* rounded-full */
        font-size: 0.75rem; /* text-xs */
        font-weight: 500; /* font-medium */
        margin-right: 0.5rem;
        margin-bottom: 0.5rem;
    }
    .badge-gray { background-color: #e5e7eb; color: #374151; } /* gray-200 / gray-700 */
    .badge-blue { background-color: #dbeafe; color: #1d4ed8; } /* blue-100 / blue-700 */
    .badge-green { background-color: #d1fae5; color: #047857; } /* green-100 / green-700 */

    /* Style for embedded HTML content */
    .html-content p { margin-bottom: 1rem; line-height: 1.6; }
    .html-content strong { font-weight: 600; }
    .html-content ul, .html-content ol { margin-left: 1.5rem; margin-bottom: 1rem; }
    .html-content li { margin-bottom: 0.5rem; }
    .html-content a { color: #2563eb; text-decoration: underline; } /* blue-600 */
</style>
{% endblock %}

{% block filters %}
    {# No filters on detail page, maybe related links? #}
    <div class="bg-white p-4 rounded-lg shadow">
        <h3 class="text-md font-semibold mb-3">Sahifalar</h3>
        <ul class="space-y-2">
             <li><a href="{% url 'university_app:university_detail' slug=direction.university.slug %}" class="text-blue-600 hover:underline">{{ direction.university.full_name }}</a></li>
             <li><a href="{% url 'university_app:university_list' %}" class="text-blue-600 hover:underline">Universitetlar Ro'yxati</a></li>
            <li><a href="{% url 'university_app:direction_list' %}" class="text-blue-600 hover:underline">Yo'nalishlar Ro'yxati</a></li>
        </ul>
    </div>
{% endblock %}

{% block content %}
<div class="bg-white p-6 md:p-8 rounded-lg shadow">

    {# Header Section #}
    <div class="mb-6 border-b pb-6">
         <nav aria-label="Breadcrumb" class="mb-4">
            <ol class="flex items-center gap-1 text-sm text-gray-600">
              <li>
                <a href="{% url 'university_app:university_list' %}" class="block transition hover:text-gray-700"> Universitetlar </a>
              </li>
              <li class="rtl:rotate-180">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"> <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/> </svg>
              </li>
              <li>
                <a href="{% url 'university_app:university_detail' slug=direction.university.slug %}" class="block transition hover:text-gray-700"> {{ direction.university.full_name }} </a>
              </li>
               <li class="rtl:rotate-180">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"> <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/> </svg>
              </li>
               <li>
                <span class="block transition text-gray-700 font-medium"> {{ direction.direction_name }} </span>
              </li>
            </ol>
          </nav>

        <h1 class="text-2xl md:text-3xl font-bold text-gray-900 mb-1">{{ direction.direction_name }}</h1>
        <p class="text-lg text-gray-700 mb-2">
            <a href="{% url 'university_app:university_detail' slug=direction.university.slug %}" class="hover:underline">
                {{ direction.university.full_name }}
            </a>
        </p>
        {% if direction.category %}
        <p class="text-md text-gray-600"><span class="detail-label">Kategoriya:</span> {{ direction.category.name }}</p>
        {% endif %}
    </div>

    {# Main Details Section #}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
        {# Left Column #}
        <div>
             <div class="detail-section">
                <p class="detail-label">Ta'lim Turlari:</p>
                 <div class="mt-1">
                    {% for type in direction.education_types.all %}
                        <span class="badge badge-gray">{{ type.name }}</span>
                    {% empty %}
                        <span class="text-gray-500 text-sm">Ma'lumot yo'q</span>
                    {% endfor %}
                </div>
            </div>

             <div class="detail-section">
                <p class="detail-label">Ta'lim Tillari:</p>
                 <div class="mt-1">
                    {% for lang in direction.education_languages.all %}
                        <span class="badge badge-blue">{{ lang.name }}</span>
                     {% empty %}
                        <span class="text-gray-500 text-sm">Ma'lumot yo'q</span>
                    {% endfor %}
                </div>
            </div>

             <div class="detail-section">
                <p class="detail-label">Darajalar:</p>
                 <div class="mt-1">
                    {% for degree in direction.degrees.all %}
                        <span class="badge badge-gray">{{ degree.name }}</span>
                     {% empty %}
                        <span class="text-gray-500 text-sm">Ma'lumot yo'q</span>
                    {% endfor %}
                </div>
            </div>

             <div class="detail-section">
                <p class="detail-label">Xususiyatlar:</p>
                <div class="mt-1">
                    {% if direction.has_stipend %}
                        <span class="badge badge-green">Stipendiya mavjud</span>
                    {% else %}
                         <span class="badge badge-gray">Stipendiya yo'q</span>
                    {% endif %}
                    {% if direction.is_open_for_admission %}
                        <span class="badge badge-green">Qabul ochiq</span>
                     {% else %}
                         <span class="badge badge-gray">Qabul yopiq</span>
                    {% endif %}
                </div>
            </div>
        </div>

        {# Right Column #}
        <div>
            {% if direction.first_subject or direction.second_subject %}
            <div class="detail-section">
                <p class="detail-label">Kirish Imtihon Fanlari:</p>
                <ul class="list-disc list-inside detail-value mt-1">
                    {% if direction.first_subject %}<li>{{ direction.first_subject }}</li>{% endif %}
                    {% if direction.second_subject %}<li>{{ direction.second_subject }}</li>{% endif %}
                </ul>
                 {% if direction.has_mandatory_subjects %}
                 <p class="text-xs text-gray-500 mt-1">(Majburiy fanlar ham bo'lishi mumkin)</p>
                 {% endif %}
            </div>
            {% endif %}

            {% if direction.application_start_date or direction.application_deadline %}
            <div class="detail-section">
                <p class="detail-label">Ariza Topshirish Muddatlari:</p>
                <p class="detail-value">
                    {% if direction.application_start_date %}
                        Boshlanish: {{ direction.application_start_date|date:"d-M, Y"|default:direction.application_start_date }}<br>
                    {% endif %}
                     {% if direction.application_deadline %}
                        Tugash: {{ direction.application_deadline|date:"d-M, Y"|default:direction.application_deadline }}
                    {% endif %}
                </p>
            </div>
            {% endif %}

             {# Display Tuition Fee Info if available/processed #}
             {# This part needs logic based on how you store/process 'tuition_fees' JSON #}
             {# Example Placeholder: #}
             {# <div class="detail-section">
                 <p class="detail-label">Kontrakt Narxi:</p>
                 <p class="detail-value">Ma'lumotni ko'rsatish uchun JSONni qayta ishlash kerak</p>
             </div> #}

        </div>
    </div>

    {# Description Section #}
    {% if direction.direction_description %}
    <div class="detail-section border-t pt-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-3">Yo'nalish Haqida</h2>
        <div class="prose max-w-none text-gray-700 html-content">
            {{ direction.direction_description|safe }}
        </div>
    </div>
    {% endif %}

    {# Requirements Section #}
    {% if direction.requirement %}
    <div class="detail-section border-t pt-6">
        <h2 class="text-xl font-semibold text-gray-800 mb-3">Talablar</h2>
        <div class="prose max-w-none text-gray-700 html-content">
            {{ direction.requirement|safe }}
        </div>
    </div>
    {% endif %}

</div>
{% endblock %}
